#!/bin/bash

set -e

APP_NAME="7sploit.app"
APP_PATH="/Applications/$APP_NAME"
ZIP_URL="https://github.com/alexkkork/install/raw/refs/heads/main/7sploit.zip"
TMP_DIR="/tmp/7sploit_installer"

clear
echo -e "\033[1;34m"
echo "███████╗███████╗██████╗ ██╗      ██████╗ ██╗████████╗"
echo "██╔════╝██╔════╝██╔══██╗██║     ██╔═══██╗██║╚══██╔══╝"
echo "███████╗█████╗  ██████╔╝██║     ██║   ██║██║   ██║   "
echo "╚════██║██╔══╝  ██╔═══╝ ██║     ██║   ██║██║   ██║   "
echo "███████║███████╗██║     ███████╗╚██████╔╝██║   ██║   "
echo "╚══════╝╚══════╝╚═╝     ╚══════╝ ╚═════╝ ╚═╝   ╚═╝   "
echo -e "\033[0m"
echo "             by Alex and 7Sleeps"
echo ""

if [ -d "$APP_PATH" ]; then
  echo "✅  $APP_NAME is already installed. Launching it now..."
  open "$APP_PATH"
  exit 0
fi

echo "🧠  Installing $APP_NAME..."
echo "🔧 Creating temp directory..."
mkdir -p "$TMP_DIR"
cd "$TMP_DIR"

echo "🔧 Downloading $APP_NAME zip from GitHub..."
curl -L "$ZIP_URL" -o 7sploit.zip

echo "🔧 Unpacking application..."
unzip -oq 7sploit.zip

if [ ! -d "$APP_NAME" ]; then
  echo "❌  Error: $APP_NAME not found after unzip!"
  exit 1
fi

echo "🔧 Moving to /Applications..."
sudo mv -f "$APP_NAME" /Applications/

echo "🚀 Launching $APP_NAME..."
open "$APP_PATH"

echo "🎉 Done! $APP_NAME installed and launched successfully."
